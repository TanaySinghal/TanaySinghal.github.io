(this["webpackJsonphaptic-library"]=this["webpackJsonphaptic-library"]||[]).push([[0],{365:function(e,t,a){e.exports=a(469)},370:function(e,t,a){},469:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),i=a(15),o=a.n(i),c=(a(370),a(89)),l=a(90),s=a(126),u=a(125),f=a(127),d=a.n(f),p=a(185),m=a(129),h=a.n(m),v=(a(375),a(470),a(516));function b(e){return g.apply(this,arguments)}function g(){return(g=Object(p.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,a){var r=new FileReader;r.readAsText(t),r.onloadend=function(t){return e(t.target.result)},r.onerror=function(e){return a(e)}})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(0===e)return"0 Bytes";var a=1024,r=t<0?0:t,n=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],i=Math.floor(Math.log(e)/Math.log(a));return parseFloat((e/Math.pow(a,i)).toFixed(r))+" "+n[i]}var E={apiKey:"AIzaSyCyUpfgybbCqs3QyDPDUinJpdOLXa7vvWo",authDomain:"hapticlibrary-39e0e.firebaseapp.com",databaseURL:"https://hapticlibrary-39e0e.firebaseio.com",projectId:"hapticlibrary-39e0e",storageBucket:"hapticlibrary-39e0e.appspot.com",messagingSenderId:"931367278707",appId:"1:931367278707:web:a39e9a14f7f55cfab13206",measurementId:"G-FLJZG4RVL8"},O=function(){function e(){var t=this;Object(c.a)(this,e),this.db=void 0,this.storage=void 0,this.haptics=function(){return t.db.collection("haptics")},h.a.initializeApp(E),this.db=h.a.firestore(),this.storage=h.a.storage()}return Object(l.a)(e,[{key:"getHapticStorageRef",value:function(e){return this.storage.ref().child("HapticFiles/"+e)}},{key:"deleteHapticFileFromStorage",value:function(e){this.storage.ref().child("HapticFiles/"+e).delete()}},{key:"getAudioStorageRef",value:function(e){return this.storage.ref().child("AudioFiles/"+e)}},{key:"deleteAudioFileFromStorage",value:function(e){return this.storage.ref().child("AudioFiles/"+e).delete()}},{key:"addHaptic",value:function(){var e=Object(p.a)(d.a.mark((function e(t,a,r,n,i,o,c,l,s,u){var f,p,m,g,y,E,O,j,P,A,w,S,F,D,T=this;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f=null===i||void 0===i?void 0:i.name,p=n.name,m=p.split(".").pop(),e.next=5,b(n);case 5:g=e.sent,(y=JSON.parse(g)).Pattern=y.Pattern.filter((function(e){return!("Event"in e)||!("EventWaveformPath"in e.Event)})),E=JSON.stringify(y),O=new Blob([E],{type:n.type}),j=Object(v.a)(),P=this.getAudioStorageRef(j),A=this.getHapticStorageRef(j),w={ID:j,Title:t,Author:"Tanay",Description:a,Tags:r,BlobType:m||"",BlobPath:A.fullPath},S=A.put(O),F=[S],S.on(h.a.storage.TaskEvent.STATE_CHANGED,(function(e){var t=e.bytesTransferred/e.totalBytes*100;c(t)})),i&&(w.AudioPath=P.fullPath,o?w.AudioParams=o:f&&(w.AudioParams={FileName:f}),D=P.put(i),F.push(D),D.on(h.a.storage.TaskEvent.STATE_CHANGED,(function(e){var t=e.bytesTransferred/e.totalBytes*100;l(t)}))),Promise.all(F).then((function(e){A.updateMetadata({contentDisposition:"attachment; filename="+p}),f&&P.updateMetadata({contentDisposition:"attachment; filename="+f}),T.haptics().doc(j).set(w),u()})).catch(s);case 19:case"end":return e.stop()}}),e,this)})));return function(t,a,r,n,i,o,c,l,s,u){return e.apply(this,arguments)}}()},{key:"deleteHaptic",value:function(e){this.haptics().doc(e).delete(),this.deleteHapticFileFromStorage(e),this.deleteAudioFileFromStorage(e).catch((function(e){return console.log("ignore error")}))}}]),e}(),j=n.a.createContext(null),P=O,A=a(83),w=a(350),S=a.n(w),F=a(499),D=a(500),T=a(501),H=a(502),R=a(503),x=a(504),k=a(505),C=a(506),B=a(507),U=a(508),L=a(509),I=a(510),W=a(511),M=a(512),N=a(513),z={Add:Object(r.forwardRef)((function(e,t){return n.a.createElement(F.a,Object.assign({},e,{ref:t}))})),Check:Object(r.forwardRef)((function(e,t){return n.a.createElement(D.a,Object.assign({},e,{ref:t}))})),Clear:Object(r.forwardRef)((function(e,t){return n.a.createElement(T.a,Object.assign({},e,{ref:t}))})),Delete:Object(r.forwardRef)((function(e,t){return n.a.createElement(H.a,Object.assign({},e,{ref:t}))})),DetailPanel:Object(r.forwardRef)((function(e,t){return n.a.createElement(R.a,Object.assign({},e,{ref:t}))})),Edit:Object(r.forwardRef)((function(e,t){return n.a.createElement(x.a,Object.assign({},e,{ref:t}))})),Export:Object(r.forwardRef)((function(e,t){return n.a.createElement(k.a,Object.assign({},e,{ref:t}))})),Filter:Object(r.forwardRef)((function(e,t){return n.a.createElement(C.a,Object.assign({},e,{ref:t}))})),FirstPage:Object(r.forwardRef)((function(e,t){return n.a.createElement(B.a,Object.assign({},e,{ref:t}))})),LastPage:Object(r.forwardRef)((function(e,t){return n.a.createElement(U.a,Object.assign({},e,{ref:t}))})),NextPage:Object(r.forwardRef)((function(e,t){return n.a.createElement(R.a,Object.assign({},e,{ref:t}))})),PreviousPage:Object(r.forwardRef)((function(e,t){return n.a.createElement(L.a,Object.assign({},e,{ref:t}))})),ResetSearch:Object(r.forwardRef)((function(e,t){return n.a.createElement(T.a,Object.assign({},e,{ref:t}))})),Search:Object(r.forwardRef)((function(e,t){return n.a.createElement(I.a,Object.assign({},e,{ref:t}))})),SortArrow:Object(r.forwardRef)((function(e,t){return n.a.createElement(W.a,Object.assign({},e,{ref:t}))})),ThirdStateCheck:Object(r.forwardRef)((function(e,t){return n.a.createElement(M.a,Object.assign({},e,{ref:t}))})),ViewColumn:Object(r.forwardRef)((function(e,t){return n.a.createElement(N.a,Object.assign({},e,{ref:t}))}))};var J,V=[{title:"Title",field:"Title",render:function(e){return function(e){return n.a.createElement("a",{download:e.Title+"."+e.BlobType,href:e.HapticDownloadURL},e.Title)}(e)}},{title:"Audio",field:"Audio",render:function(e){return function(e){var t,a=null===(t=e.AudioParams)||void 0===t?void 0:t.FileName,r=e.AudioDownloadURL;return r&&n.a.createElement("a",{download:a,href:r},a||"[unnamed]")}(e)}},{title:"Tags",field:"Tags"},{title:"Description",field:"Description"}],G=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(e){var r;return Object(c.a)(this,a),(r=t.call(this,e)).state={data:[]},r}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=this.props.firebase;t.haptics().onSnapshot((function(a){var r=a.docs.map((function(e){return e.data()})).sort((function(e,t){var a=e.Title.toUpperCase(),r=t.Title.toUpperCase();return a<r?-1:a>r?1:0})),n=r.map((function(e){return t.getHapticStorageRef(e.ID).getDownloadURL()})),i=r.map((function(e){return e.AudioPath?t.getAudioStorageRef(e.ID).getDownloadURL():Promise.resolve()}));Promise.all([Promise.all(n),Promise.all(i)]).then((function(t){var a=t[0],n=t[1],i=r.map((function(e,t){return Object(A.a)(Object(A.a)({},e),{},{HapticDownloadURL:a[t],AudioDownloadURL:n[t]})}));e.setState({data:i})}))}))}},{key:"render",value:function(){var e=this.props.firebase,t=this.state.data.map((function(e){return Object(A.a)(Object(A.a)({},e),{},{Tags:e.Tags?e.Tags.join(", "):""})}));return n.a.createElement(S.a,{title:"Haptic Library",columns:V,data:t,icons:z,localization:{body:{editRow:{deleteText:"Are you sure you want to delete this haptic effect?"}}},style:{padding:"20px"},editable:{onRowDelete:function(t){return new Promise((function(a){setTimeout((function(){a(),e.deleteHaptic(t.ID)}),600)}))}},components:{Container:function(e){return n.a.createElement(n.a.Fragment,null,e.children)}},options:{pageSize:20}})}}]),a}(r.Component),K=a(358),q=a(92),Z=a(330),_=a(348),Q=a(328),X=a(340),Y=a(514),$=a(357),ee=a.n($);!function(e){e.Error="error",e.Warning="warning",e.Info="info",e.Success="success"}(J||(J={}));var te={hapticFile:null,audioFile:null,audioParams:null,title:"",description:"",tags:[],uploadProgressHaptic:null,uploadProgressAudio:null,alertDict:{}},ae=32,re=188,ne={maxWidth:"360px",marginTop:"20px",marginBottom:"20px",display:"flex",flexWrap:"wrap"};function ie(e){var t=function(e){for(var t=e.Pattern,a=0;a<t.length;a++){var r=t[a];if("Event"in r){var n=r.Event;if("EventWaveformPath"in n)return n}}return null}(e);if(null===t)return null;var a={},r=t.EventWaveformPath;if(a.FileName=r?r.split("/").slice(-1)[0]:null,a.Time=t.Time,"EventParameters"in t)for(var n=t.EventParameters,i=0;i<n.length;i++){var o=n[i],c=o.ParameterID,l=o.ParameterValue;switch(c){case"AudioBrightness":a.AudioBrightness=l;break;case"AudioPan":a.AudioPan=l;break;case"AudioPitch":a.AudioPitch=l;break;case"AudioVolume":a.AudioVolume=l}}return a}var oe=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(e){var r;return Object(c.a)(this,a),(r=t.call(this,e)).onAudioFile=function(e){var t=e.target.files,a=t?t[0]:null;if(a){var n=Object.assign({},r.state.alertDict);a.size>1048576?n["Audio File Error"]={severity:J.Error,text:"Please limit audio file size to ".concat(y(1048576),".")}:delete n["Audio File Error"],r.setState({audioFile:a,alertDict:n})}else r.setState({audioFile:a})},r.onHapticFile=function(e){var t=e.target.files,a=t?t[0]:null;if(a){var n=Object.assign({},r.state.alertDict),i="Haptic File Error";if(a.size>102400)return n[i]={severity:J.Error,text:"Please limit haptic (.ahap) file size to ".concat(y(102400),".")},void r.setState({hapticFile:a,alertDict:n});var o=a.name.split(".")[0];b(a).then((function(e){try{var t=JSON.parse(e);if(!("Pattern"in t)||!("Version"in t))throw new Error("Haptic file is not in valid AHAP format.");var c="";if("Metadata"in t){var l=t.Metadata;"Description"in l&&(c=l.Description)}var s=Object.assign({},r.state.alertDict);delete s[i],r.setState({hapticFile:a,audioParams:ie(t),title:o,description:c,alertDict:s})}catch(u){n[i]={severity:J.Error,text:"Haptic file is not in valid AHAP format."},r.setState({alertDict:n}),console.log(u)}}))}else r.setState({hapticFile:a})},r.onSubmit=function(e){var t=r.props.firebase,a=r.state,n=a.audioFile,i=a.audioParams,o=a.description,c=a.hapticFile,l=a.tags,s=a.title;e.preventDefault();var u=Object.assign({},r.state.alertDict);if(0===s.length)return u["Upload Error"]={severity:J.Error,text:"Please enter a title."},void r.setState({alertDict:u});if(!c)return u["Upload Error"]={severity:J.Error,text:"Please upload an AHAP file."},void r.setState({alertDict:u});t.addHaptic(s,o,l,c,n,i,(function(e){r.setState({uploadProgressHaptic:e})}),(function(e){r.setState({uploadProgressAudio:e})}),(function(e){}),(function(){u["Upload Error"]={severity:J.Success,text:"Uploaded ".concat(s,"!")},r.setState(Object(A.a)(Object(A.a)({},te),{},{alertDict:u}))}))},r.state=Object(A.a)({},te),r}return Object(l.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=t.alertDict,r=t.audioParams,i=t.description,o=t.hapticFile,c=t.audioFile,l=t.tags,s=t.title,u=t.uploadProgressAudio,f=t.uploadProgressHaptic;return n.a.createElement(n.a.Fragment,null,n.a.createElement(q.a,{variant:"h6"},"Add AHAP Entry"),n.a.createElement("form",{onSubmit:this.onSubmit},n.a.createElement(Z.a,{variant:"outlined",component:"label",color:"primary",style:ne},"Upload AHAP File",n.a.createElement("input",{id:"haptic-file",name:"Haptic File",type:"file",accept:".ahap,.json",style:{display:"none"},key:o?o.name:"",onChange:this.onHapticFile})),o&&n.a.createElement(_.a,{style:ne,label:"Selected: "+o.name}),n.a.createElement(Z.a,{variant:"outlined",component:"label",color:"primary",style:ne},"Upload Audio File",n.a.createElement("input",{id:"audio-file",name:"Audio File",type:"file",accept:"audio/*",style:{display:"none"},key:c?c.name:"",onChange:this.onAudioFile})),c&&n.a.createElement(_.a,{style:ne,label:"Selected: "+c.name}),!c&&r&&r.FileName&&n.a.createElement(Y.a,{severity:J.Warning},"This AHAP file requires the audio file ".concat(r.FileName,". \n              Please upload it if you would like to include an audio sample.")),n.a.createElement(Q.a,{name:"Title",value:s,onChange:function(t){return e.setState({title:t.target.value})},type:"text",label:"Title",variant:"outlined",style:ne}),n.a.createElement(Q.a,{name:"Description",value:i,onChange:function(t){return e.setState({description:t.target.value})},type:"text",label:"Description",variant:"outlined",style:ne}),n.a.createElement(ee.a,{value:l,onAdd:function(t){return e.setState({tags:[].concat(Object(K.a)(l),[t])})},onDelete:function(t,a){return e.setState({tags:l.filter((function(e,t){return t!==a}))})},newChipKeyCodes:[re,ae],label:"Tags",variant:"outlined",style:ne}),n.a.createElement(Z.a,{type:"submit",color:"primary",variant:"contained",style:ne},"Add Haptics"),null!==u&&n.a.createElement(X.a,{variant:"determinate",style:ne,value:u}),null!==f&&n.a.createElement(X.a,{variant:"determinate",style:ne,value:f}),Object.keys(a)&&Object.keys(a).map((function(e){var t=a[e];return n.a.createElement(Y.a,{key:e,severity:t.severity},t.text)}))))}}]),a}(r.Component),ce=a(498),le=a(193),se={padding:"50px",margin:"20px"},ue=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){return n.a.createElement(j.Consumer,null,(function(e){if(e)return n.a.createElement(ce.a,{maxWidth:"md"},n.a.createElement(le.a,{style:se},n.a.createElement(q.a,{variant:"h4"},"Haptic Library"),n.a.createElement("br",null),n.a.createElement(q.a,{variant:"subtitle1"},"Welcome to the Haptic Library! This tool lets you easily share haptic sensations designed for ",n.a.createElement("a",{href:"https://developer.apple.com/documentation/corehaptics"},"iOS Core Haptics"),", which is available on iOS 13 and on iPhone 8 or newer (not iPhone SE). To design these experiences, consider using tools such as "," ",n.a.createElement("a",{href:"http://ahap.fancypixel.it/"},"Captain AHAP"),", ",n.a.createElement("a",{href:"https://composer.lofelt.com/"},"Lofelt Composer"),", or ",n.a.createElement("a",{href:"https://medium.com/flawless-app-stories/haptrix-core-haptics-designer-241a47b78cd"},"Haptrix"),". After uploading, you can then view these sensations in a client app for iOS (ask Tanay for access).")),n.a.createElement(le.a,{style:se},n.a.createElement(oe,{firebase:e})),n.a.createElement(le.a,{style:se},n.a.createElement(G,{firebase:e})))}))}}]),a}(r.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(j.Provider,{value:new P},n.a.createElement(ue,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[365,1,2]]]);
//# sourceMappingURL=main.261beba9.chunk.js.map